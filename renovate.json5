{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: ["github>pulumi/renovate-config//default.json5"],
  packageRules: [
    {
      matchDatasources: ["npm", "gomod"],
      matchPackageNames: ["@pulumi/aws", "github.com/pulumi/pulumi-aws/sdk/v7"],
      postUpgradeTasks: {
        commands: ["make renovate"],
        executionMode: "branch", // Only run once. 
      },
      groupName: "upstream AWS dependencies",
      groupSlug: "aws",
      // automatically bump these, don't require manual trigger
      dependencyDashboardApproval: false,
    },
    {
      matchDatasources: ["npm", "go", "golang-version"],
      // Dependent files need to be rebuilt when key dependencies change.
      //
      // https://docs.renovatebot.com/configuration-options/#postupgradetasks
      postUpgradeTasks: {
        commands: ["make renovate"],
        executionMode: "branch", // Only run once.
      },
    },
    {
      // Override first-party Pulumi dependencies to update only between 12am and 3am
      matchManagers: ["gomod"],
      matchPackageNames: ["github.com/pulumi/**", "!github.com/pulumi/terraform-plugin-sdk/v2"],
      ignoreUnstable: false, // Accept latest.
      matchDepTypes: ["require", "indirect"], // pkg can sometimes be an indirect dependency.

      groupName: "first-party Pulumi dependencies",
      groupSlug: "pulumi",
      dependencyDashboardApproval: false,
      "schedule": ["* 0-3 * * *"], // 
      "updateNotScheduled": false,
    },
  ],
  automerge: false
}
